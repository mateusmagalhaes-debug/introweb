<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>calculadora master</title>
    <style>
        :root{
            --bg:#0f1724;
            --panel:#0b1220;
            --accent:#06b6d4;
            --text:#e6eef6;
            --muted:#94a3b8;
            --btn-bg:#111827;
        }
        *{box-sizing:border-box}
        html,body{height:100%;margin:0;font-family:Segoe UI, Roboto, Arial, sans-serif;background:linear-gradient(180deg,#071126 0%, #0b1220 100%);color:var(--text);display:flex;align-items:center;justify-content:center}
        .calculator{width:340px;max-width:95%;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.1));border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
        .display{height:64px;background:transparent;border-radius:8px;padding:12px;display:flex;flex-direction:column;justify-content:center;align-items:flex-end;gap:4px}
        .display .expr{color:var(--muted);font-size:14px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;width:100%}
        .display .value{font-size:26px;font-weight:600}
        .keys{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:12px}
        button{border:0;border-radius:8px;padding:14px;font-size:18px;color:var(--text);background:var(--btn-bg);cursor:pointer;box-shadow:inset 0 -2px 0 rgba(0,0,0,0.2)}
        button.operator{background:linear-gradient(180deg,#0b3a3f,#04464b);color:#fff}
        button.equal{grid-column:span 2;background:var(--accent);color:#04202a;font-weight:700}
        button.clear{background:linear-gradient(180deg,#3b0b0b,#5e0b0b);}
        button:active{transform:translateY(1px)}
        .meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
        .meta small{color:var(--muted)}
        @media (max-width:420px){.display .value{font-size:22px}.calculator{padding:14px}}
    </style>
</head>
<body>
    <main class="calculator" role="application" aria-label="Calculadora básica">
        <div class="meta">
            <small>Calculadora</small>
            <small id="tip">Enter = calcular · Esc = limpar</small>
        </div>
        <div class="display" aria-live="polite">
            <div class="expr" id="expr">&nbsp;</div>
            <div class="value" id="display">0</div>
        </div>

        <div class="keys">
            <button class="clear" data-action="clear" title="Limpar (Esc)">C</button>
            <button data-action="back" title="Apagar (Backspace)">⌫</button>
            <button data-action="percent">%</button>
            <button class="operator" data-value="/">÷</button>

            <button data-value="7">7</button>
            <button data-value="8">8</button>
            <button data-value="9">9</button>
            <button class="operator" data-value="*">×</button>

            <button data-value="4">4</button>
            <button data-value="5">5</button>
            <button data-value="6">6</button>
            <button class="operator" data-value="-">−</button>

            <button data-value="1">1</button>
            <button data-value="2">2</button>
            <button data-value="3">3</button>
            <button class="operator" data-value="+">+</button>

            <button data-value="0" style="grid-column:span 2;text-align:left;padding-left:22px">0</button>
            <button data-value=".">.</button>
            <button class="equal" data-action="equals">=</button>
        </div>
    </main>

    <script>
        (function(){
            const displayEl = document.getElementById('display');
            const exprEl = document.getElementById('expr');
            let expr = '';

            function update(){
                exprEl.textContent = expr || '\u00A0';
                displayEl.textContent = expr ? expr : '0';
            }

            function sanitize(input){
                // allow digits, operators, parentheses and dot
                return input.replace(/[^0-9+\-*/().%]/g,'');
            }

            function calculate(){
                if(!expr) return;
                try{
                    // replace unicode operators if any
                    let toEval = expr.replace(/×/g,'*').replace(/[−—–]/g,'-').replace(/÷/g,'/');
                    // handle percent: convert 'number%' to (number/100)
                    toEval = toEval.replace(/(\d+(?:\.\d+)?)%/g, '($1/100)');
                    toEval = sanitize(toEval);
                    // Evaluate safely using Function
                    let result = Function('return (' + toEval + ')')();
                    if(!isFinite(result)){
                        displayEl.textContent = 'Erro';
                        expr = '';
                        return;
                    }
                    // trim long floats
                    if(typeof result === 'number'){
                        result = Math.round((result + Number.EPSILON) * 1e12)/1e12;
                    }
                    expr = String(result);
                    update();
                }catch(e){
                    displayEl.textContent = 'Erro';
                    expr = '';
                }
            }

            // handle button clicks
            document.querySelectorAll('button').forEach(btn=>{
                btn.addEventListener('click', ()=>{
                    const v = btn.dataset.value;
                    const action = btn.dataset.action;
                    if(action === 'clear'){
                        expr = '';
                        update();
                        return;
                    }
                    if(action === 'back'){
                        expr = expr.slice(0,-1);
                        update();
                        return;
                    }
                    if(action === 'equals'){
                        calculate();
                        return;
                    }
                    if(action === 'percent'){
                        expr += '%';
                        update();
                        return;
                    }
                    if(v){
                        expr += v;
                        update();
                    }
                });
            });

            // keyboard support
            window.addEventListener('keydown', (ev)=>{
                if(ev.key === 'Enter'){
                    ev.preventDefault();
                    calculate();
                    return;
                }
                if(ev.key === 'Escape'){
                    expr = '';
                    update();
                    return;
                }
                if(ev.key === 'Backspace'){
                    expr = expr.slice(0,-1);
                    update();
                    return;
                }
                // allow digits and operators
                const allowed = '0123456789+-*/().%';
                if(allowed.includes(ev.key)){
                    expr += ev.key;
                    update();
                    return;
                }
            });

            // initial render
            update();
        })();
    </script>
</body>
</html>